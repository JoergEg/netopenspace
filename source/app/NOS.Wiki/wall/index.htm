<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head profile="http://gmpg.org/xfn/11">
	<title>.NET Open Space</title>
	
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	
	<meta name="robots" content="noindex, follow">
	
	<link rel="stylesheet" href="css/base.css" type="text/css" media="screen">

	<script type="text/javascript" src="script/jquery-1.4.1.min.js"></script>
	<script type="text/javascript" src="http://jquery-jsonp.googlecode.com/files/jquery.jsonp-1.0.6.min.js"></script>
	<script type="text/javascript" src="script/monitter.js"></script>
	
	<script type="text/javascript">
	$(document).ready(function()
	{
		String.prototype.startsWith = function(instance, ignoreCase)
		{
			if (ignoreCase)
			{
				return (instance == this.substring(0, instance.length));
			}

			return (instance.toLowerCase() == this.substring(0, instance.length).toLowerCase());
		};
		
		$.getJSON('http://netopenspace.de/all-net-open-spaces.json?json=?',
			function(json)
			{
				var developmentFilter = function(item)
				{
					return !(!document.URL.startsWith("http://nos.local") && item.Private);
				}
				
				json = $.grep(json, developmentFilter);
							
				var query = $(json).map(function() {
					return this.TwitterSearch;
				});
				
				query = $.makeArray(query).join(' OR ');
				
				$('.loading').fadeOut();
				
				var prefixWithZero = function(value)
				{
					if (value < 10)
					{
						return '0' + value;
					}
					return value;
				}
				
				$('#tweets')
					.attr('rel', query)
					.monitter({
						limit: 12,
						timeout: 10000,
						callback: function(params, status) {
							var nextUpdate = new Date();
							nextUpdate = new Date(params.timeout + nextUpdate.getTime());
							
							var hours = prefixWithZero(nextUpdate.getHours());
							var minutes = prefixWithZero(nextUpdate.getMinutes());
							var seconds = prefixWithZero(nextUpdate.getSeconds());
							$('#last-update')
								.attr('class', status)
								.text("Nächste Aktualisierung: " + hours + ":" + minutes + ":" + seconds);
						}
					});
			});
	});
	</script>
</head>
<body id="body">
	<div id="wrapper">
		<a href="http://netopenspace.de/"><h1>Twitter-Hashtag <em>#netos2010</em> benutzen!</h1></a>
		<div id="next-update"></div>
		<div id="tweets">
			<span class="loading" style="display: block; text-align: center; padding-top: 100px;"><img src="images/ajax-loader.gif" alt="Laden..." /></span>
		</div>
	</div>
</body></html>